<form method="post">
  {% csrf_token %}
  {{ form.non_field_errors }}

  <div class="form-row">
    <div class="form-group col-md-6">
      {{ form.username.label_tag }}
      {{ form.username }}
      {{ form.username.errors }}
    </div>
    <div class="form-group col-md-6">
      {{ form.email.label_tag }}
      {{ form.email }}
      {{ form.email.errors }}
    </div>
  </div>

  <div class="form-row">
    <div class="form-group col-md-6">
      {{ form.role.label_tag }}
      {{ form.role }}
      {{ form.role.errors }}
    </div>
    <div class="form-group col-md-6 d-flex align-items-center">
      <div class="form-check mt-4">
        {{ form.is_active }}
        {{ form.is_active.label_tag }}
        {{ form.is_active.errors }}
      </div>
    </div>
  </div>

  <!-- 新增：密码设置 / 修改 -->
  <div class="form-row">
    <div class="form-group col-md-6">
      {{ form.password1.label_tag }}
      {{ form.password1 }}
      {{ form.password1.errors }}
      {% if form.instance.pk %}
        <small class="form-text text-muted">
          如需修改密码，请输入新密码；留空则保持原密码不变。
        </small>
      {% else %}
        <small class="form-text {% if form.errors %}text-danger{% else %}text-muted{% endif %}">
          *请为新用户设置初始密码（至少 8 位）。
        </small>
      {% endif %}
    </div>
    <div class="form-group col-md-6">
      {{ form.password2.label_tag }}
      {{ form.password2 }}
      {{ form.password2.errors }}
    </div>
  </div>

  <div class="mt-3">
    <button type="submit" class="btn btn-primary">保存</button>
  </div>
</form>
