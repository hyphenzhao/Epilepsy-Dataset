<div>
  <h5 class="mb-3">
    {{ patient.name }} 的文件下载管理
  </h5>

  <h6 class="mt-3">患者信息</h6>
  <p class="text-muted small mb-2">
    按照术前评估报告分区导出当前患者的所有信息。
  </p>
  <div class="btn-group mb-3" role="group" aria-label="患者信息导出">
    <a class="btn btn-sm btn-outline-primary"
       href="{% url 'epilepsy:patient_export' patient.id 'csv' %}">
      导出CSV
    </a>
    <a class="btn btn-sm btn-outline-primary"
       href="{% url 'epilepsy:patient_export' patient.id 'word' %}">
      导出Word
    </a>
  </div>

  {# MRI 文件 #}
  <h6 class="mt-3">MRI 文件</h6>
  {% if mri_files %}
    <table class="table table-sm align-middle">
      <thead>
        <tr>
          <th>文件名</th>
          <th>上传时间</th>
          <th style="width: 120px;">操作</th>
        </tr>
      </thead>
      <tbody>
        {% for f in mri_files %}
          <tr>
            <td>{{ f.file_name }}</td>
            <td>{{ f.created_at|date:"Y-m-d H:i" }}</td>
            <td>
              <a class="btn btn-sm btn-outline-primary"
                 href="{% url 'epilepsy:patient_file_download' 'mri' f.id %}">
                下载
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="text-muted small mb-2">暂无 MRI 文件。</p>
  {% endif %}

  {# PET 文件 #}
  <h6 class="mt-3">PET 文件</h6>
  {% if pet_files %}
    <table class="table table-sm align-middle">
      <thead>
        <tr>
          <th>文件名</th>
          <th>上传时间</th>
          <th style="width: 120px;">操作</th>
        </tr>
      </thead>
      <tbody>
        {% for f in pet_files %}
          <tr>
            <td>{{ f.file_name }}</td>
            <td>{{ f.created_at|date:"Y-m-d H:i" }}</td>
            <td>
              <a class="btn btn-sm btn-outline-primary"
                 href="{% url 'epilepsy:patient_file_download' 'pet' f.id %}">
                下载
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="text-muted small mb-2">暂无 PET 文件。</p>
  {% endif %}

  {# EEG 文件 #}
  <h6 class="mt-3">EEG 文件</h6>
  {% if eeg_files %}
    <table class="table table-sm align-middle">
      <thead>
        <tr>
          <th>文件名</th>
          <th>上传时间</th>
          <th style="width: 120px;">操作</th>
        </tr>
      </thead>
      <tbody>
        {% for f in eeg_files %}
          <tr>
            <td>{{ f.file_name }}</td>
            <td>{{ f.created_at|date:"Y-m-d H:i" }}</td>
            <td>
              <a class="btn btn-sm btn-outline-primary"
                 href="{% url 'epilepsy:patient_file_download' 'eeg' f.id %}">
                下载
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="text-muted small mb-2">暂无 EEG 文件。</p>
  {% endif %}

  {# SEEG 文件 #}
  <h6 class="mt-3">SEEG 文件</h6>
  {% if seeg_files %}
    <table class="table table-sm align-middle">
      <thead>
        <tr>
          <th>文件名</th>
          <th>上传时间</th>
          <th style="width: 120px;">操作</th>
        </tr>
      </thead>
      <tbody>
        {% for f in seeg_files %}
          <tr>
            <td>{{ f.file_name }}</td>
            <td>{{ f.created_at|date:"Y-m-d H:i" }}</td>
            <td>
              <a class="btn btn-sm btn-outline-primary"
                 href="{% url 'epilepsy:patient_file_download' 'seeg' f.id %}">
                下载
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="text-muted small mb-0">暂无 SEEG 文件。</p>
  {% endif %}
</div>
